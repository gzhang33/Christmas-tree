<story-context id="2-1-theme-config" v="1.0">
  <metadata>
    <epicId>2</epicId>
    <storyId>2-1</storyId>
    <title>Theme &amp; Asset Configuration</title>
    <status>drafted</status>
    <generatedAt>2025-12-01</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/stories/2-1-theme-config.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>Developer</asA>
    <iWant>to centralize theme and asset configuration</iWant>
    <soThat>the application uses the correct "Midnight Magic" colors and textures</soThat>
    <tasks>
- [ ] Create `src/config` directory and files (AC: 1, 2, 3)
  - [ ] Implement `theme.ts` with Midnight Magic hex codes
  - [ ] Implement `assets.ts` with asset paths
- [ ] Update `useStore` to use config defaults (AC: 4)
  - [ ] Import theme constants in `useStore.ts`
- [ ] Refactor `TreeParticles.tsx` (AC: 4)
  - [ ] Replace hardcoded colors with `useStore` selector
  - [ ] Verify particles render with new theme colors
- [ ] Verify Build and Lint
  - [ ] Run type check
    </tasks>
  </story>

  <acceptanceCriteria>
1. `src/config` directory is created and populated.
2. `src/config/theme.ts` exports "Midnight Magic" palette constants matching UX Spec.
3. `src/config/assets.ts` defines paths for particle textures and photo placeholders.
4. `TreeParticles` component is updated to consume color values from `useStore` (initialized from config) instead of hardcoded values.
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/ux-design-specification.md</path>
        <title>UX Design Specification</title>
        <section>3.1 Color System</section>
        <snippet>
Theme: Midnight Magic
Primary: #D53F8C (Neon Pink)
Secondary: #805AD5 (Electric Purple)
Accent: #38B2AC (Teal)
Background: #1A202C (Dark Slate)
Surface: #2D3748
        </snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>Architecture Decision Document</title>
        <section>4. Project Structure</section>
        <snippet>
src/config/
  theme.ts            # Colors, particle distributions
  assets.ts           # Asset paths constants
        </snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>Architecture Decision Document</title>
        <section>6. Implementation Patterns</section>
        <snippet>
Asset Management:
No Hardcoding: src/assets/image.png is forbidden in components.
Registry: Use src/config/assets.ts
        </snippet>
      </doc>
    </docs>
    <code>
      <item>
        <path>src/store/useStore.ts</path>
        <kind>file</kind>
        <symbol>useStore</symbol>
        <lines>18-36</lines>
        <reason>Central state management that needs to be updated to use config defaults.</reason>
      </item>
      <item>
        <path>src/components/canvas/TreeParticles.tsx</path>
        <kind>file</kind>
        <symbol>TreeParticles</symbol>
        <lines>118-135</lines>
        <reason>Currently contains hardcoded COLORS object that needs to be replaced with store/config values.</reason>
      </item>
    </code>
    <dependencies>
      <package name="zustand" version="^5.0.9" />
      <package name="three" version="^0.165.0" />
    </dependencies>
  </artifacts>

  <constraints>
    <constraint>Use `src/config` for static constants.</constraint>
    <constraint>`TreeParticles` should read from store, not config directly, to allow dynamic theme switching.</constraint>
    <constraint>Ensure asset paths in `assets.ts` match actual file locations in `public/`.</constraint>
  </constraints>

  <interfaces>
    <interface>
      <name>AppState</name>
      <kind>interface</kind>
      <signature>
export interface AppState {
    theme: string;
    particleCount: number;
    isExploded: boolean;
    activePhotoId: string | null;
    setTheme: (theme: string) => void;
    setParticleCount: (count: number) => void;
    triggerExplosion: () => void;
    resetExplosion: () => void;
    setActivePhoto: (id: string | null) => void;
}
      </signature>
      <path>src/store/useStore.ts</path>
    </interface>
  </interfaces>

  <tests>
    <standards>
      Verify that the application builds without type errors.
      Visually verify that the "Midnight Magic" colors are applied to the tree particles.
      Check that changing the theme in the store (if implemented) updates the particles.
    </standards>
    <locations>
      src/components/canvas/TreeParticles.tsx
    </locations>
    <ideas>
      Test that `useStore` initializes with values from `theme.ts`.
      Test that `TreeParticles` renders with the correct colors from the store.
    </ideas>
  </tests>
</story-context>
