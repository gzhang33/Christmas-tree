<story-context id="bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>1</epicId>
    <storyId>1.1</storyId>
    <title>Tech Stack & Directory Refactor</title>
    <status>drafted</status>
    <generatedAt>2025-12-01</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/stories/1-1-tech-stack-refactor.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>Developer</asA>
    <iWant>install the required dependencies and restructure the project</iWant>
    <soThat>the codebase aligns with the approved Architecture Spec</soThat>
    <tasks>
- [ ] Install dependencies: `npm install zustand framer-motion` and `npm install -D tailwindcss postcss autoprefixer` (AC: 1)
- [ ] Initialize Tailwind: `npx tailwindcss init -p` (AC: 2)
- [ ] Configure `tailwind.config.js` with content paths (AC: 2)
- [ ] Add Tailwind directives to `index.css` (AC: 2)
- [ ] Create directory structure: `src/components/canvas`, `src/components/ui`, `src/hooks`, `src/store`, `src/config`, `src/shaders`, `src/utils`, `src/types` (AC: 3)
- [ ] Move `TreeParticles.tsx` to `src/components/canvas/` (AC: 4)
- [ ] Move `Controls.tsx` to `src/components/ui/` (AC: 4)
- [ ] Update imports in moved files to resolve paths (AC: 4)
- [ ] Update `App.tsx` imports (AC: 4)
- [ ] Verify application builds and runs without errors (AC: 1, 2, 3, 4)
    </tasks>
  </story>

  <acceptanceCriteria>
1. `zustand`, `framer-motion`, `tailwindcss`, `postcss`, `autoprefixer` are installed.
2. Tailwind is initialized with `tailwind.config.js`.
3. The directory structure matches the Architecture Spec (`components/canvas`, `components/ui`, `hooks`, `store`, `config`).
4. Existing files are moved to their new locations (even if not yet refactored).
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/architecture.md</path>
        <title>Architecture Decision Document</title>
        <section>2. Project Initialization & Foundation</section>
        <snippet>Required Infrastructure Updates: Install Tailwind CSS, Install Zustand, Install Framer Motion, Refactor Directory.</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>Architecture Decision Document</title>
        <section>4. Project Structure</section>
        <snippet>Defines the new directory structure: src/components/canvas, src/components/ui, src/hooks, src/store, etc.</snippet>
      </doc>
      <doc>
        <path>docs/epics.md</path>
        <title>Epic Breakdown</title>
        <section>Story 1.1: Tech Stack & Directory Refactor</section>
        <snippet>Detailed requirements and technical notes for this story.</snippet>
      </doc>
    </docs>
    <code>
      <item>
        <path>components/TreeParticles.tsx</path>
        <kind>component</kind>
        <symbol>TreeParticles</symbol>
        <reason>Needs to be moved to src/components/canvas/</reason>
      </item>
      <item>
        <path>components/Controls.tsx</path>
        <kind>component</kind>
        <symbol>Controls</symbol>
        <reason>Needs to be moved to src/components/ui/</reason>
      </item>
      <item>
        <path>App.tsx</path>
        <kind>file</kind>
        <symbol>App</symbol>
        <reason>Imports need to be updated after moving components.</reason>
      </item>
      <item>
        <path>package.json</path>
        <kind>config</kind>
        <reason>Dependencies need to be added.</reason>
      </item>
    </code>
    <dependencies>
      <ecosystem name="npm">
        <package name="react" version="^18.2.0" />
        <package name="three" version="^0.165.0" />
        <package name="@react-three/fiber" version="^8.16.8" />
        <package name="vite" version="^5.4.0" />
        <package name="typescript" version="~5.4.0" />
      </ecosystem>
    </dependencies>
  </artifacts>

  <constraints>
    <constraint>Strict separation of concerns: components/canvas for R3F/WebGL components and components/ui for DOM/React components.</constraint>
    <constraint>Ensure all new folders are created even if empty.</constraint>
  </constraints>

  <interfaces>
  </interfaces>

  <tests>
    <standards>Verify application builds and runs without errors.</standards>
    <locations></locations>
    <ideas>
      <idea>Run `npm run build` to verify build success.</idea>
      <idea>Run `npm run dev` and check console for errors.</idea>
    </ideas>
  </tests>
</story-context>
